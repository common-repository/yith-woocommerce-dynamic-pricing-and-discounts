jQuery(document).ready(function(r){"use strict";function l(t){t.each(function(){var n=r(this),t=n.data("field"),e=n.find("option:selected");d(n,e.val(),t),n.on("change",function(){var t=n.data("field"),e=n.find("option:selected");d(n,e.val(),t)})})}var t=r(document).find(".ywdpd-sections-group").find(".ywdpd-section").find(".yith-ywdpd-eventype-select"),e="undefined"!=typeof yith_ywdpd_admin&&yith_ywdpd_admin.del_msg,a=yith_ywdpd_admin.ajaxurl+"?action=ywdpd_admin_action",d=function(t,n,e){t.closest(".ywdpd-select-wrapper").find("tr.deps-"+e).each(function(){var t=r(this).data("type").split(";");if(-1!==r.inArray(n,t))r(this).show();else if(r(this).hide(),void 0!==r(this).data("rel")){var e="deps-"+r(this).data("rel");r(this).parents(".ywdpd-section").find("."+e).hide()}})};if(r(document).on("click",".add-row",function(){var t=r(this),e=t.closest("table"),n=t.closest("tr"),a=parseInt(n.data("index")),d=n.clone(),i=e.find("tr"),o=1;d.find("select").removeClass("enhanced"),d.find("span.select2").remove(),i.each(function(){var t=r(this).data("index");o<t&&(o=t)});var c=o+1;d.attr("data-index",c),d.find("[name*='rules']").each(function(){var t=r(this),e=t.attr("name"),n=t.attr("id"),d=e.replace("[rules]["+a+"]","[rules]["+c+"]"),i=n.replace("[rules]["+a+"]","[rules]["+c+"]");t.attr("name",d),t.attr("id",i),t.val("")}),d.find(".remove-row").removeClass("hide-remove"),e.append(d),r(document.body).trigger("wc-enhanced-select-init");var s=d.find(".yith-ywdpd-eventype-select");l(s)}),r(document).on("click",".remove-row",function(){r(this).closest("tr").remove()}),r("table.widefat.wp-list-table.discounts tr").append('<td class="column-handle"></td>'),jQuery(".ywdpd-sections-group").sortable({items:".ywdpd-section-handle",cursor:"move",axis:"y",handle:"form",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",start:function(t,e){e.item.css("background-color","#f6f6f6")},stop:function(t,e){e.item.removeAttr("style");var n=r(".ywdpd-section-handle"),d=0,i=new Array;for(d=0;d<n.length;d++)i[d]=r(n[d]).data("key");0<i.length&&r.post(a,{ywdpd_action:"order_section",tab:r(".form-table").closest(".yit-admin-panel-content-wrap-full").data("type"),order_keys:i},function(t){})}}),l(t),r("#_discount_type").length){var n=r("#_discount_type").data("std"),i=r(".page-title-action").attr("href");r("#_discount_type").attr("value",n),r(".page-title-action").attr("href",i+"&ywdpd_discount_type="+n)}var o=r("#ywdpd_cart_discount").find(".yith-ywdpd-eventype-select");if(l(o),r(".wp-list-table.discounts").sortable({items:"tbody tr:not(.inline-edit-row)",cursor:"move",handle:".column-handle",axis:"y",forcePlaceholderSize:!0,helper:"clone",opacity:.65,start:function(t,e){e.item.css("background-color","#f6f6f6")},stop:function(t,e){e.item.removeAttr("style");var n=e.item.find(".check-column input").val(),d=e.item.prev().find(".check-column input").val(),i=e.item.next().find(".check-column input").val();r.post(a,{ywdpd_action:"table_order_section",type:r("#ywdpd-discount-list-table").data("type"),roleid:n,previd:d,nextid:i},function(t){})}}),r("#ywdpd-discount-list-table").on("submit",function(){if("delete"==r(this).find("#bulk-action-selector-top").val())return 1==window.confirm(e)}),r(".cart_discount,.cart_discount_type").show(),r(document).find("body").hasClass("post-type-ywdpd_discount")){var c=r(".subsubsub").find("li a"),s=r(".row-actions"),p="";r(document).find("body").hasClass("ywdpd-discount-type-cart")&&(p="cart"),r(document).find("body").hasClass("ywdpd-discount-type-pricing")&&(p="pricing"),0<r(document).find("#ywdpd_discount_type").length&&(p=r(document).find("#ywdpd_discount_type").val()),r.each(c,function(){var t=r(this),e=t.attr("href");e+="&ywdpd_discount_type="+p,t.attr("href",e)}),r.each(s,function(){var t=r(this).find("a");r.each(t,function(){var t=r(this),e=t.attr("href");e+="&ywdpd_discount_type="+p,t.attr("href",e)})});var u=r(document).find("a.page-title-action");0<u.length&&r.each(u,function(){var t=r(this),e=t.attr("href");e+="&ywdpd_discount_type="+p,t.attr("href",e)});var y=r(document).find("#posts-filter");r("<input>").attr({type:"hidden",value:p,name:"ywdpd_discount_type"}).appendTo(y)}r(document).on("change",".ywdpd-toggle-enabled input",function(){var t="yes"===r(this).val()?"yes":"no",e=r(this).closest(".ywdpd-toggle-enabled"),n=e.data("discount-id"),d=e.data("security");r.ajax({type:"POST",data:{ywdpd_action:"discount_toggle_enabled",id:n,enabled:t,security:d},url:a,success:function(t){void 0!==t.error&&alert(t.error)}})})});